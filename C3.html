<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì•„ì„¸í†¤ ì¦ë°œ ì‹œë®¬ë ˆì´ì…˜ - ì…ìì˜ ìš´ë™</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
            margin-top: 10px;
        }

        .curriculum-info {
            background: #f7fafc;
            padding: 20px;
            border-bottom: 3px solid #667eea;
        }

        .curriculum-info h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }

        .info-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .info-item strong {
            color: #667eea;
            display: block;
            margin-bottom: 5px;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 20px;
            padding: 30px;
        }

        .simulation-area {
            background: #f7fafc;
            border-radius: 15px;
            padding: 20px;
        }

        .canvas-container {
            position: relative;
            background: white;
            border: 3px solid #2d3748;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        #simulationCanvas {
            display: block;
            width: 100%;
            border-radius: 8px;
        }

        .scale-display {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(255,255,255,0.95);
            padding: 15px 25px;
            border-radius: 10px;
            border: 3px solid #2d3748;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .scale-display .label {
            font-size: 0.9em;
            color: #4a5568;
            margin-bottom: 5px;
        }

        .scale-display .mass {
            font-size: 2em;
            font-weight: bold;
            color: #2d3748;
        }

        .scale-display .unit {
            font-size: 0.9em;
            color: #718096;
        }

        .controls {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .controls h3 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .control-group {
            margin-bottom: 25px;
        }

        .control-group label {
            display: block;
            color: #4a5568;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        input[type="range"] {
            flex: 1;
            height: 8px;
            border-radius: 5px;
            background: #e2e8f0;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .value-display {
            min-width: 70px;
            text-align: center;
            font-weight: bold;
            color: #2d3748;
            background: #f7fafc;
            padding: 8px 12px;
            border-radius: 6px;
        }

        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        button {
            padding: 15px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .btn-start {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
        }

        .btn-start:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(72,187,120,0.4);
        }

        .btn-pause {
            background: linear-gradient(135deg, #f6ad55 0%, #ed8936 100%);
            color: white;
        }

        .btn-pause:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(237,137,54,0.4);
        }

        .btn-reset {
            background: linear-gradient(135deg, #fc8181 0%, #f56565 100%);
            color: white;
        }

        .btn-reset:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(245,101,101,0.4);
        }

        .btn-save {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            grid-column: 1 / -1;
        }

        .btn-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(102,126,234,0.4);
        }

        .stats-panel {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .stats-panel h4 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: white;
            margin-bottom: 10px;
            border-radius: 6px;
            border-left: 3px solid #667eea;
        }

        .stat-label {
            color: #4a5568;
        }

        .stat-value {
            font-weight: bold;
            color: #2d3748;
        }

        .quiz-section {
            background: white;
            padding: 30px;
            border-top: 3px solid #667eea;
        }

        .quiz-section h3 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.4em;
        }

        .quiz-question {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .quiz-question p {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.1em;
            line-height: 1.6;
        }

        .quiz-options {
            display: grid;
            gap: 10px;
        }

        .quiz-option {
            padding: 15px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-option:hover {
            border-color: #667eea;
            background: #edf2f7;
        }

        .quiz-option.selected {
            border-color: #667eea;
            background: #ebf4ff;
        }

        .quiz-option.correct {
            border-color: #48bb78;
            background: #f0fff4;
        }

        .quiz-option.incorrect {
            border-color: #f56565;
            background: #fff5f5;
        }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: #f0fff4;
            border-left: 4px solid #48bb78;
            color: #22543d;
        }

        .feedback.incorrect {
            background: #fff5f5;
            border-left: 4px solid #f56565;
            color: #742a2a;
        }

        .explanation-box {
            background: #ebf8ff;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #4299e1;
            margin-top: 20px;
        }

        .explanation-box h4 {
            color: #2c5282;
            margin-bottom: 10px;
        }

        .explanation-box p {
            color: #2d3748;
            line-height: 1.8;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .pulsing {
            animation: pulse 2s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§ª ì•„ì„¸í†¤ ì¦ë°œ ì‹œë®¬ë ˆì´ì…˜</h1>
            <p>ì…ìì˜ ìš´ë™ìœ¼ë¡œ ì´í•´í•˜ëŠ” ë¬¼ì§ˆì˜ ë³€í™”</p>
        </div>

        <div class="curriculum-info">
            <h3>ğŸ“š êµìœ¡ê³¼ì • ì •ë³´</h3>
            <div class="info-grid">
                <div class="info-item">
                    <strong>í•™ë…„/ê³¼ëª©</strong>
                    ì¤‘í•™êµ 1í•™ë…„ / ê³¼í•™
                </div>
                <div class="info-item">
                    <strong>ë‹¨ì›</strong>
                    ê¸°ì²´ì˜ ì„±ì§ˆ
                </div>
                <div class="info-item">
                    <strong>ì„±ì·¨ê¸°ì¤€</strong>
                    [9ê³¼04-01] ë¬¼ì§ˆì„ ì´ë£¨ëŠ” ì…ìì˜ ìš´ë™ê³¼ í™•ì‚°, ì¦ë°œ í˜„ìƒ ì„¤ëª…
                </div>
                <div class="info-item">
                    <strong>í•™ìŠµ ëª©í‘œ</strong>
                    ì…ì ëª¨í˜•ì„ í†µí•´ ì¦ë°œ í˜„ìƒì˜ ì›ë¦¬ ì´í•´
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="simulation-area">
                <div class="canvas-container">
                    <canvas id="simulationCanvas" width="800" height="600"></canvas>
                    <div class="scale-display">
                        <div class="label">ì „ìì €ìš¸</div>
                        <div class="mass" id="massDisplay">5.00</div>
                        <div class="unit">g</div>
                    </div>
                </div>

                <div class="explanation-box">
                    <h4>ğŸ’¡ ì‹¤í—˜ ì„¤ëª…</h4>
                    <p>
                        ê±°ë¦„ì¢…ì´ ìœ„ì— ì•„ì„¸í†¤ì„ ë–¨ì–´ëœ¨ë¦¬ê³  ì „ìì €ìš¸ë¡œ ì§ˆëŸ‰ì„ ì¸¡ì •í•©ë‹ˆë‹¤. 
                        ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ì•„ì„¸í†¤ ì…ìë“¤ì´ ê³µê¸° ì¤‘ìœ¼ë¡œ í¼ì ¸ë‚˜ê°€ë©´ì„œ ì§ˆëŸ‰ì´ ê°ì†Œí•©ë‹ˆë‹¤.
                        íŒŒë€ìƒ‰ ì…ìëŠ” ì•„ì„¸í†¤ ë¶„ìë¥¼ ë‚˜íƒ€ë‚´ë©°, ì´ë“¤ì€ ëŠì„ì—†ì´ ë¬´ì‘ìœ„ë¡œ ìš´ë™í•˜ê³  ìˆìŠµë‹ˆë‹¤.
                    </p>
                </div>
            </div>

            <div class="controls">
                <h3>âš™ï¸ ì‹¤í—˜ ì¡°ê±´</h3>
                
                <div class="control-group">
                    <label>ì‹œê°„ (ì´ˆ)</label>
                    <div class="slider-container">
                        <input type="range" id="timeSlider" min="0" max="300" value="0" step="1">
                        <div class="value-display" id="timeValue">0ì´ˆ</div>
                    </div>
                </div>

                <div class="control-group">
                    <label>ì˜¨ë„ (â„ƒ)</label>
                    <div class="slider-container">
                        <input type="range" id="tempSlider" min="10" max="40" value="25" step="5">
                        <div class="value-display" id="tempValue">25â„ƒ</div>
                    </div>
                </div>

                <div class="control-group">
                    <label>ì´ˆê¸° ì…ì ìˆ˜</label>
                    <div class="slider-container">
                        <input type="range" id="particleSlider" min="50" max="200" value="100" step="10">
                        <div class="value-display" id="particleValue">100ê°œ</div>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn-start" id="startBtn">â–¶ï¸ ì‹œì‘</button>
                    <button class="btn-pause" id="pauseBtn">â¸ï¸ ì¼ì‹œì •ì§€</button>
                    <button class="btn-reset" id="resetBtn">ğŸ”„ ì´ˆê¸°í™”</button>
                    <button class="btn-save" id="saveBtn">ğŸ’¾ ê²°ê³¼ ì €ì¥</button>
                </div>

                <div class="stats-panel">
                    <h4>ğŸ“Š ì‹¤ì‹œê°„ ë°ì´í„°</h4>
                    <div class="stat-item">
                        <span class="stat-label">ë‚¨ì€ ì…ì ìˆ˜</span>
                        <span class="stat-value" id="particleCount">100ê°œ</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ì¦ë°œë¥ </span>
                        <span class="stat-value" id="evapRate">0%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ì§ˆëŸ‰ ê°ì†ŒëŸ‰</span>
                        <span class="stat-value" id="massLoss">0.00g</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">í‰ê·  ì…ì ì†ë„</span>
                        <span class="stat-value" id="avgSpeed">-</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="quiz-section">
            <h3>ğŸ¯ í•™ìŠµ í‰ê°€</h3>
            
            <div class="quiz-question" id="quiz1">
                <p><strong>ë¬¸ì œ 1.</strong> ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ì „ìì €ìš¸ì˜ ì§ˆëŸ‰ì´ ì¤„ì–´ë“œëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”?</p>
                <div class="quiz-options">
                    <div class="quiz-option" data-quiz="1" data-answer="false">
                        â‘  ì•„ì„¸í†¤ ì…ìê°€ ë¶„í•´ë˜ì–´ ì‚¬ë¼ì§€ê¸° ë•Œë¬¸ì´ë‹¤
                    </div>
                    <div class="quiz-option" data-quiz="1" data-answer="true">
                        â‘¡ ì•„ì„¸í†¤ ì…ìê°€ ê³µê¸° ì¤‘ìœ¼ë¡œ í¼ì ¸ë‚˜ê°€ê¸° ë•Œë¬¸ì´ë‹¤
                    </div>
                    <div class="quiz-option" data-quiz="1" data-answer="false">
                        â‘¢ ì•„ì„¸í†¤ ì…ìê°€ ê±°ë¦„ì¢…ì´ì— í¡ìˆ˜ë˜ê¸° ë•Œë¬¸ì´ë‹¤
                    </div>
                    <div class="quiz-option" data-quiz="1" data-answer="false">
                        â‘£ ì „ìì €ìš¸ì˜ ì¸¡ì • ì˜¤ë¥˜ ë•Œë¬¸ì´ë‹¤
                    </div>
                </div>
                <div class="feedback" id="feedback1"></div>
            </div>

            <div class="quiz-question" id="quiz2">
                <p><strong>ë¬¸ì œ 2.</strong> ì˜¨ë„ê°€ ë†’ì•„ì§€ë©´ ì¦ë°œ ì†ë„ê°€ ë¹¨ë¼ì§€ëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”?</p>
                <div class="quiz-options">
                    <div class="quiz-option" data-quiz="2" data-answer="false">
                        â‘  ì…ìì˜ ê°œìˆ˜ê°€ ëŠ˜ì–´ë‚˜ê¸° ë•Œë¬¸ì´ë‹¤
                    </div>
                    <div class="quiz-option" data-quiz="2" data-answer="true">
                        â‘¡ ì…ìì˜ ìš´ë™ ì—ë„ˆì§€ê°€ ì»¤ì ¸ ë” í™œë°œí•˜ê²Œ ìš´ë™í•˜ê¸° ë•Œë¬¸ì´ë‹¤
                    </div>
                    <div class="quiz-option" data-quiz="2" data-answer="false">
                        â‘¢ ì…ìì˜ í¬ê¸°ê°€ ì‘ì•„ì§€ê¸° ë•Œë¬¸ì´ë‹¤
                    </div>
                    <div class="quiz-option" data-quiz="2" data-answer="false">
                        â‘£ ê³µê¸°ì˜ ì••ë ¥ì´ ë‚®ì•„ì§€ê¸° ë•Œë¬¸ì´ë‹¤
                    </div>
                </div>
                <div class="feedback" id="feedback2"></div>
            </div>

            <div class="quiz-question" id="quiz3">
                <p><strong>ë¬¸ì œ 3.</strong> (ì„œìˆ í˜•) ì‹œë®¬ë ˆì´ì…˜ì—ì„œ ê´€ì°°í•œ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ, ì…ì ëª¨í˜•ì„ ì‚¬ìš©í•˜ì—¬ ì•„ì„¸í†¤ì˜ ì¦ë°œ í˜„ìƒì„ ì„¤ëª…í•´ë³´ì„¸ìš”.</p>
                <textarea id="essay3" rows="6" style="width: 100%; padding: 15px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1em; font-family: inherit; resize: vertical;"></textarea>
                <div class="explanation-box" style="margin-top: 15px;">
                    <h4>âœ… ëª¨ë²” ë‹µì•ˆ ìš”ì†Œ</h4>
                    <ul style="margin-left: 20px; line-height: 2;">
                        <li>ì•„ì„¸í†¤ì€ ëˆˆì— ë³´ì´ì§€ ì•ŠëŠ” ì‘ì€ ì…ìë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤</li>
                        <li>ì…ìë“¤ì€ ëŠì„ì—†ì´ ë¬´ì‘ìœ„ë¡œ ìš´ë™í•œë‹¤</li>
                        <li>ê±°ë¦„ì¢…ì´ ìœ„ì˜ ì…ìë“¤ì´ ê³µê¸° ì¤‘ìœ¼ë¡œ í¼ì ¸ë‚˜ê°„ë‹¤</li>
                        <li>ì…ìê°€ ë¹ ì ¸ë‚˜ê°€ë©´ì„œ ì „ìì €ìš¸ì˜ ì§ˆëŸ‰ì´ ê°ì†Œí•œë‹¤</li>
                        <li>ì´ëŸ¬í•œ í˜„ìƒì„ ì¦ë°œì´ë¼ê³  í•œë‹¤</li>
                    </ul>
                </div>
            </div>

            <div class="explanation-box">
                <h4>ğŸ”¬ ê³¼í•™ ì›ë¦¬: ê¸°ì²´ ë¶„ì ìš´ë™ë¡ </h4>
                <p>
                    <strong>1. ì…ìì˜ ìš´ë™:</strong> ëª¨ë“  ë¬¼ì§ˆì„ ì´ë£¨ëŠ” ì…ìëŠ” ëŠì„ì—†ì´ ìš´ë™í•©ë‹ˆë‹¤.<br>
                    <strong>2. ì˜¨ë„ì™€ ìš´ë™ ì—ë„ˆì§€:</strong> ì˜¨ë„ê°€ ë†’ì„ìˆ˜ë¡ ì…ìì˜ í‰ê·  ìš´ë™ ì—ë„ˆì§€ê°€ í½ë‹ˆë‹¤.<br>
                    <strong>3. ì¦ë°œ:</strong> ì•¡ì²´ ì…ìê°€ í‘œë©´ì—ì„œ ê¸°ì²´ë¡œ ìƒíƒœê°€ ë³€í•˜ëŠ” í˜„ìƒì…ë‹ˆë‹¤.<br>
                    <strong>4. í™•ì‚°:</strong> ì…ìê°€ ë†ë„ê°€ ë†’ì€ ê³³ì—ì„œ ë‚®ì€ ê³³ìœ¼ë¡œ í¼ì§€ëŠ” í˜„ìƒì…ë‹ˆë‹¤.<br>
                    <strong>5. ì§ˆëŸ‰ ë³´ì¡´:</strong> ì•„ì„¸í†¤ì´ ì‚¬ë¼ì§„ ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, ì‹¤ì œë¡œëŠ” ê³µê¸° ì¤‘ìœ¼ë¡œ í¼ì§„ ê²ƒì…ë‹ˆë‹¤.
                </p>
            </div>
        </div>
    </div>

    <script>
        // ìº”ë²„ìŠ¤ ì„¤ì •
        const canvas = document.getElementById('simulationCanvas');
        const ctx = canvas.getContext('2d');

        // ì‹œë®¬ë ˆì´ì…˜ ë³€ìˆ˜
        let particles = [];
        let isRunning = false;
        let timeElapsed = 0;
        let initialParticleCount = 100;
        let temperature = 25;
        let animationId = null;

        // ê±°ë¦„ì¢…ì´ ì˜ì—­
        const filterPaper = {
            x: 300,
            y: 250,
            radius: 100
        };

        // ì…ì í´ë˜ìŠ¤
        class Particle {
            constructor(x, y, temp) {
                this.x = x;
                this.y = y;
                this.radius = 3;
                this.baseSpeed = 0.5 + (temp - 10) / 60; // ì˜¨ë„ì— ë”°ë¥¸ ì†ë„
                this.angle = Math.random() * Math.PI * 2;
                this.vx = Math.cos(this.angle) * this.baseSpeed;
                this.vy = Math.sin(this.angle) * this.baseSpeed;
                this.alpha = 1;
                this.inPaper = true;
            }

            update() {
                // ë¬´ì‘ìœ„ ìš´ë™ (ë¸Œë¼ìš´ ìš´ë™)
                this.angle += (Math.random() - 0.5) * 0.2;
                this.vx = Math.cos(this.angle) * this.baseSpeed;
                this.vy = Math.sin(this.angle) * this.baseSpeed;

                this.x += this.vx;
                this.y += this.vy;

                // ê±°ë¦„ì¢…ì´ ì˜ì—­ í™•ì¸
                const distFromCenter = Math.sqrt(
                    Math.pow(this.x - filterPaper.x, 2) + 
                    Math.pow(this.y - filterPaper.y, 2)
                );

                if (distFromCenter > filterPaper.radius) {
                    this.inPaper = false;
                    // ê±°ë¦„ì¢…ì´ ë°–ìœ¼ë¡œ ë‚˜ê°„ ì…ìëŠ” íˆ¬ëª…ë„ ê°ì†Œ
                    this.alpha -= 0.005;
                }

                // ìº”ë²„ìŠ¤ ê²½ê³„ ì²˜ë¦¬ (ë¶€ë“œëŸ¬ìš´ ë°˜ì‚¬)
                if (this.x < 0 || this.x > canvas.width) {
                    this.vx *= -1;
                    this.x = Math.max(0, Math.min(canvas.width, this.x));
                }
                if (this.y < 0 || this.y > canvas.height) {
                    this.vy *= -1;
                    this.y = Math.max(0, Math.min(canvas.height, this.y));
                }
            }

            draw() {
                if (this.alpha > 0) {
                    ctx.save();
                    ctx.globalAlpha = this.alpha;
                    
                    // ì…ì ê·¸ë¦¬ê¸° (ê·¸ë¼ë””ì–¸íŠ¸ íš¨ê³¼)
                    const gradient = ctx.createRadialGradient(
                        this.x, this.y, 0,
                        this.x, this.y, this.radius
                    );
                    gradient.addColorStop(0, '#4299e1');
                    gradient.addColorStop(1, '#2b6cb0');
                    
                    ctx.fillStyle = gradient;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // ì™¸ê³½ì„ 
                    ctx.strokeStyle = '#2c5282';
                    ctx.lineWidth = 0.5;
                    ctx.stroke();
                    
                    ctx.restore();
                }
            }

            isVisible() {
                return this.alpha > 0.01;
            }
        }

        // ì´ˆê¸°í™” í•¨ìˆ˜
        function initSimulation() {
            particles = [];
            const particleCount = parseInt(document.getElementById('particleSlider').value);
            initialParticleCount = particleCount;
            temperature = parseInt(document.getElementById('tempSlider').value);

            // ê±°ë¦„ì¢…ì´ ì˜ì—­ ë‚´ì— ì…ì ë°°ì¹˜
            for (let i = 0; i < particleCount; i++) {
                const angle = Math.random() * Math.PI * 2;
                const distance = Math.random() * filterPaper.radius * 0.8;
                const x = filterPaper.x + Math.cos(angle) * distance;
                const y = filterPaper.y + Math.sin(angle) * distance;
                particles.push(new Particle(x, y, temperature));
            }

            timeElapsed = 0;
            updateTimeSlider(0);
            updateStats();
        }

        // ê·¸ë¦¬ê¸° í•¨ìˆ˜
        function draw() {
            // ë°°ê²½
            ctx.fillStyle = '#edf2f7';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // í™•ì‚° ì˜ì—­ ì‹œê°í™” (íˆíŠ¸ë§µ íš¨ê³¼)
            drawDiffusionArea();

            // ê±°ë¦„ì¢…ì´ ê·¸ë¦¬ê¸°
            ctx.save();
            ctx.fillStyle = '#f7fafc';
            ctx.strokeStyle = '#2d3748';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.arc(filterPaper.x, filterPaper.y, filterPaper.radius, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // ê±°ë¦„ì¢…ì´ ë¼ë²¨
            ctx.fillStyle = '#4a5568';
            ctx.font = 'bold 16px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('ê±°ë¦„ì¢…ì´', filterPaper.x, filterPaper.y);
            
            ctx.restore();

            // ì…ì ê·¸ë¦¬ê¸°
            particles.forEach(particle => particle.draw());

            // ì •ë³´ í‘œì‹œ
            drawInfo();
        }

        // í™•ì‚° ì˜ì—­ ì‹œê°í™”
        function drawDiffusionArea() {
            // ì…ì ë°€ë„ ê¸°ë°˜ íˆíŠ¸ë§µ
            const cellSize = 40;
            const cols = Math.ceil(canvas.width / cellSize);
            const rows = Math.ceil(canvas.height / cellSize);
            const density = Array(rows).fill(0).map(() => Array(cols).fill(0));

            particles.forEach(p => {
                if (p.alpha > 0.1) {
                    const col = Math.floor(p.x / cellSize);
                    const row = Math.floor(p.y / cellSize);
                    if (row >= 0 && row < rows && col >= 0 && col < cols) {
                        density[row][col]++;
                    }
                }
            });

            const maxDensity = Math.max(...density.flat());
            
            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    if (density[row][col] > 0) {
                        const alpha = (density[row][col] / maxDensity) * 0.3;
                        ctx.fillStyle = `rgba(102, 126, 234, ${alpha})`;
                        ctx.fillRect(col * cellSize, row * cellSize, cellSize, cellSize);
                    }
                }
            }
        }

        // ì •ë³´ í‘œì‹œ
        function drawInfo() {
            // ì‹œê°„ í‘œì‹œ
            ctx.fillStyle = '#2d3748';
            ctx.font = 'bold 20px sans-serif';
            ctx.textAlign = 'left';
            ctx.fillText(`â±ï¸ ê²½ê³¼ ì‹œê°„: ${timeElapsed.toFixed(1)}ì´ˆ`, 20, 30);
            
            // ì˜¨ë„ í‘œì‹œ
            ctx.fillText(`ğŸŒ¡ï¸ ì˜¨ë„: ${temperature}â„ƒ`, 20, 60);

            // ë²”ë¡€
            ctx.font = '14px sans-serif';
            ctx.fillStyle = '#4299e1';
            ctx.beginPath();
            ctx.arc(30, 90, 5, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#2d3748';
            ctx.fillText('ì•„ì„¸í†¤ ì…ì', 45, 95);
        }

        // ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function update() {
            if (!isRunning) return;

            particles.forEach(particle => particle.update());
            particles = particles.filter(particle => particle.isVisible());

            timeElapsed += 0.1;
            updateTimeSlider(timeElapsed);
            updateStats();

            draw();

            if (particles.length > 0) {
                animationId = requestAnimationFrame(update);
            } else {
                isRunning = false;
                alert('ëª¨ë“  ì•„ì„¸í†¤ì´ ì¦ë°œí–ˆìŠµë‹ˆë‹¤! ğŸ‰\nì…ìë“¤ì´ ê³µê¸° ì¤‘ìœ¼ë¡œ ì™„ì „íˆ í¼ì ¸ë‚˜ê°”ìŠµë‹ˆë‹¤.');
            }
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats() {
            const remainingParticles = particles.length;
            const evaporationRate = ((initialParticleCount - remainingParticles) / initialParticleCount * 100).toFixed(1);
            const currentMass = (5.0 * remainingParticles / initialParticleCount).toFixed(2);
            const massLoss = (5.0 - currentMass).toFixed(2);
            
            // í‰ê·  ì†ë„ ê³„ì‚°
            let avgSpeed = 0;
            if (particles.length > 0) {
                const totalSpeed = particles.reduce((sum, p) => {
                    return sum + Math.sqrt(p.vx * p.vx + p.vy * p.vy);
                }, 0);
                avgSpeed = (totalSpeed / particles.length).toFixed(2);
            }

            document.getElementById('particleCount').textContent = `${remainingParticles}ê°œ`;
            document.getElementById('evapRate').textContent = `${evaporationRate}%`;
            document.getElementById('massDisplay').textContent = currentMass;
            document.getElementById('massLoss').textContent = `${massLoss}g`;
            document.getElementById('avgSpeed').textContent = avgSpeed > 0 ? `${avgSpeed} px/frame` : '-';
        }

        // ì‹œê°„ ìŠ¬ë¼ì´ë” ì—…ë°ì´íŠ¸
        function updateTimeSlider(time) {
            const slider = document.getElementById('timeSlider');
            slider.value = Math.min(time, 300);
            document.getElementById('timeValue').textContent = `${Math.floor(time)}ì´ˆ`;
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.getElementById('startBtn').addEventListener('click', () => {
            if (!isRunning) {
                isRunning = true;
                update();
            }
        });

        document.getElementById('pauseBtn').addEventListener('click', () => {
            isRunning = false;
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            isRunning = false;
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            initSimulation();
            draw();
        });

        document.getElementById('tempSlider').addEventListener('input', (e) => {
            temperature = parseInt(e.target.value);
            document.getElementById('tempValue').textContent = `${temperature}â„ƒ`;
            
            // ì˜¨ë„ ë³€ê²½ ì‹œ ì…ì ì†ë„ ì—…ë°ì´íŠ¸
            particles.forEach(p => {
                p.baseSpeed = 0.5 + (temperature - 10) / 60;
            });
        });

        document.getElementById('particleSlider').addEventListener('input', (e) => {
            const value = e.target.value;
            document.getElementById('particleValue').textContent = `${value}ê°œ`;
        });

        document.getElementById('timeSlider').addEventListener('input', (e) => {
            const value = e.target.value;
            document.getElementById('timeValue').textContent = `${value}ì´ˆ`;
        });

        // ê²°ê³¼ ì €ì¥ ê¸°ëŠ¥
        document.getElementById('saveBtn').addEventListener('click', () => {
            const report = generateReport();
            downloadReport(report);
        });

        function generateReport() {
            const remainingParticles = particles.length;
            const evaporationRate = ((initialParticleCount - remainingParticles) / initialParticleCount * 100).toFixed(1);
            const currentMass = (5.0 * remainingParticles / initialParticleCount).toFixed(2);

            return `
ì•„ì„¸í†¤ ì¦ë°œ ì‹¤í—˜ ê²°ê³¼ ë³´ê³ ì„œ
========================================

ì‹¤í—˜ ì¼ì‹œ: ${new Date().toLocaleString('ko-KR')}

[ì‹¤í—˜ ì¡°ê±´]
- ì´ˆê¸° ì…ì ìˆ˜: ${initialParticleCount}ê°œ
- ì˜¨ë„: ${temperature}â„ƒ
- ê²½ê³¼ ì‹œê°„: ${timeElapsed.toFixed(1)}ì´ˆ

[ì‹¤í—˜ ê²°ê³¼]
- ë‚¨ì€ ì…ì ìˆ˜: ${remainingParticles}ê°œ
- ì¦ë°œë¥ : ${evaporationRate}%
- í˜„ì¬ ì§ˆëŸ‰: ${currentMass}g
- ì§ˆëŸ‰ ê°ì†ŒëŸ‰: ${(5.0 - currentMass).toFixed(2)}g

[ê´€ì°° ë‚´ìš©]
1. ì•„ì„¸í†¤ ì…ìëŠ” ëŠì„ì—†ì´ ë¬´ì‘ìœ„ë¡œ ìš´ë™í•©ë‹ˆë‹¤.
2. ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ì…ìë“¤ì´ ê±°ë¦„ì¢…ì´ ë°–ìœ¼ë¡œ í¼ì ¸ë‚˜ê°‘ë‹ˆë‹¤.
3. ì…ìê°€ ë¹ ì ¸ë‚˜ê°€ë©´ì„œ ì „ìì €ìš¸ì˜ ì§ˆëŸ‰ì´ ê°ì†Œí•©ë‹ˆë‹¤.
4. ì˜¨ë„ê°€ ë†’ì„ìˆ˜ë¡ ì…ìì˜ ìš´ë™ì´ í™œë°œí•˜ì—¬ ì¦ë°œì´ ë¹ ë¦…ë‹ˆë‹¤.

[ê²°ë¡ ]
ë¬¼ì§ˆì€ ëˆˆì— ë³´ì´ì§€ ì•ŠëŠ” ì‘ì€ ì…ìë¡œ ì´ë£¨ì–´ì ¸ ìˆìœ¼ë©°, 
ì´ ì…ìë“¤ì˜ ìš´ë™ì´ ì¦ë°œê³¼ ê°™ì€ ë¬¼ì§ˆì˜ ë³€í™”ë¥¼ ì¼ìœ¼í‚µë‹ˆë‹¤.
ì•„ì„¸í†¤ì´ ì‚¬ë¼ì§„ ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, ì‹¤ì œë¡œëŠ” ê³µê¸° ì¤‘ìœ¼ë¡œ 
í¼ì ¸ë‚˜ê°„ ê²ƒìœ¼ë¡œ, ë¬¼ì§ˆì˜ ì´ëŸ‰ì€ ë³´ì¡´ë©ë‹ˆë‹¤.
========================================
            `;
        }

        function downloadReport(content) {
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ì•„ì„¸í†¤_ì¦ë°œ_ì‹¤í—˜_ê²°ê³¼_${Date.now()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            alert('ì‹¤í—˜ ê²°ê³¼ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ“„');
        }

        // í€´ì¦ˆ ê¸°ëŠ¥
        document.querySelectorAll('.quiz-option').forEach(option => {
            option.addEventListener('click', function() {
                const quizNum = this.getAttribute('data-quiz');
                const isCorrect = this.getAttribute('data-answer') === 'true';
                const feedback = document.getElementById(`feedback${quizNum}`);
                
                // ì„ íƒ ì´ˆê¸°í™”
                document.querySelectorAll(`[data-quiz="${quizNum}"]`).forEach(opt => {
                    opt.classList.remove('selected', 'correct', 'incorrect');
                });

                // ì„ íƒ í‘œì‹œ
                this.classList.add('selected');
                
                if (isCorrect) {
                    this.classList.add('correct');
                    feedback.className = 'feedback show correct';
                    feedback.innerHTML = 'âœ… <strong>ì •ë‹µì…ë‹ˆë‹¤!</strong><br>ì…ìë“¤ì´ ëŠì„ì—†ì´ ìš´ë™í•˜ë©´ì„œ ê±°ë¦„ì¢…ì´ ë°–ìœ¼ë¡œ í¼ì ¸ë‚˜ê°€ ì§ˆëŸ‰ì´ ê°ì†Œí•©ë‹ˆë‹¤.';
                } else {
                    this.classList.add('incorrect');
                    feedback.className = 'feedback show incorrect';
                    feedback.innerHTML = 'âŒ <strong>ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”.</strong><br>ì…ì ëª¨í˜•ì„ ë– ì˜¬ë ¤ë³´ì„¸ìš”. ì…ìë“¤ì€ ì–´ë””ë¡œ ì´ë™í• ê¹Œìš”?';
                }
            });
        });

        // ì´ˆê¸°í™”
        initSimulation();
        draw();
    </script>
</body>
</html>
