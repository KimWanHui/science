<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>기체의 확산 실험 시뮬레이션 - 중학교 1학년 과학</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.95;
        }

        .achievement {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-size: 0.95em;
        }

        .main-content {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 30px;
            padding: 30px;
        }

        .control-panel {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .control-section {
            margin-bottom: 25px;
        }

        .control-section h3 {
            color: #1976D2;
            margin-bottom: 15px;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-group {
            margin-bottom: 15px;
        }

        .control-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
            font-size: 0.95em;
        }

        .btn-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 15px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
            flex: 1;
            min-width: 70px;
        }

        .btn:hover {
            background: #f0f0f0;
            transform: translateY(-2px);
        }

        .btn.active {
            background: #2196F3;
            color: white;
            border-color: #2196F3;
        }

        .slider-container {
            margin-bottom: 10px;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #2196F3;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #2196F3;
            cursor: pointer;
        }

        .slider-value {
            text-align: center;
            font-weight: 600;
            color: #2196F3;
            margin-top: 5px;
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .primary-btn {
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .start-btn {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
        }

        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }

        .reset-btn {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            color: white;
        }

        .reset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 152, 0, 0.4);
        }

        .report-btn {
            background: linear-gradient(135deg, #9c27b0 0%, #7b1fa2 100%);
            color: white;
        }

        .report-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(156, 39, 176, 0.4);
        }

        .experiment-area {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .simulation-container {
            background: #f0f4f8;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            position: relative;
            min-height: 400px;
        }

        #experimentCanvas {
            width: 100%;
            height: 350px;
            background: white;
            border-radius: 10px;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.1);
        }

        .timer-display {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.95);
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 1.5em;
            font-weight: 700;
            color: #2196F3;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .status-indicator {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.95em;
        }

        .status-ready {
            background: #e3f2fd;
            color: #1976D2;
        }

        .status-running {
            background: #e8f5e9;
            color: #388E3C;
            animation: pulse 2s infinite;
        }

        .status-complete {
            background: #fff3e0;
            color: #f57c00;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .results-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .result-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .result-card h4 {
            color: #1976D2;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        #graphCanvas {
            width: 100%;
            height: 250px;
            background: white;
            border-radius: 8px;
        }

        .data-table {
            width: 100%;
            font-size: 0.9em;
        }

        .data-table td {
            padding: 8px;
            border-bottom: 1px solid #e0e0e0;
        }

        .data-table td:first-child {
            font-weight: 600;
            color: #555;
        }

        .data-table td:last-child {
            text-align: right;
            color: #2196F3;
            font-weight: 600;
        }

        .feedback-section {
            background: #e3f2fd;
            padding: 25px;
            border-radius: 12px;
            margin-top: 25px;
        }

        .feedback-section h3 {
            color: #1976D2;
            margin-bottom: 20px;
            font-size: 1.2em;
        }

        .question-card {
            background: white;
            padding: 18px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #2196F3;
        }

        .question-card p {
            color: #333;
            line-height: 1.6;
            font-size: 0.95em;
        }

        .hint-box {
            background: #fff3e0;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            border-left: 4px solid #ff9800;
        }

        .hint-box p {
            color: #f57c00;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .particle-legend {
            display: flex;
            gap: 20px;
            margin-top: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .results-section {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🧪 기체의 확산 실험 시뮬레이션</h1>
            <p>암모니아 기체의 확산 현상을 관찰하고 입자 운동으로 설명해봅시다</p>
            <div class="achievement">
                <strong>성취기준:</strong> 중1 과학 4-01 "기체의 확산 현상을 관찰하고, 입자 운동으로 설명한다."<br>
                <strong>단원:</strong> Ⅳ. 기체의 성질
            </div>
        </div>

        <div class="main-content">
            <!-- 조작 패널 -->
            <div class="control-panel">
                <div class="control-section">
                    <h3>🌡️ 실험 조건 설정</h3>
                    
                    <div class="control-group">
                        <label>온도 조건</label>
                        <div class="btn-group">
                            <button class="btn" data-temp="10">저온<br>10°C</button>
                            <button class="btn active" data-temp="25">상온<br>25°C</button>
                            <button class="btn" data-temp="40">고온<br>40°C</button>
                        </div>
                    </div>

                    <div class="control-group">
                        <label>암모니아 농도 (방울 수)</label>
                        <div class="slider-container">
                            <input type="range" id="dropSlider" min="1" max="3" value="2" step="1">
                            <div class="slider-value"><span id="dropValue">2</span> 방울</div>
                        </div>
                    </div>

                    <div class="control-group">
                        <label>빨대 길이</label>
                        <div class="btn-group">
                            <button class="btn" data-length="short">짧음<br>20cm</button>
                            <button class="btn active" data-length="medium">보통<br>30cm</button>
                            <button class="btn" data-length="long">김<br>40cm</button>
                        </div>
                    </div>
                </div>

                <div class="control-section">
                    <h3>🎮 실험 제어</h3>
                    <div class="action-buttons">
                        <button class="primary-btn start-btn" id="startBtn">▶️ 실험 시작</button>
                        <button class="primary-btn reset-btn" id="resetBtn">🔄 초기화</button>
                        <button class="primary-btn report-btn" id="reportBtn">📊 보고서 생성</button>
                    </div>
                </div>

                <div class="control-section">
                    <h3>ℹ️ 실험 안내</h3>
                    <div style="font-size: 0.9em; line-height: 1.6; color: #555;">
                        <p style="margin-bottom: 10px;">
                            <strong>실험 방법:</strong><br>
                            1. 원하는 온도와 농도를 선택하세요<br>
                            2. 실험 시작 버튼을 누르세요<br>
                            3. 입자의 움직임과 색 변화를 관찰하세요
                        </p>
                        <p style="background: #fff3e0; padding: 10px; border-radius: 5px; margin-top: 10px;">
                            <strong>💡 관찰 포인트:</strong><br>
                            • 온도에 따른 입자 속도 변화<br>
                            • 지시약 종이의 색 변화 시점<br>
                            • 확산 거리와 시간의 관계
                        </p>
                    </div>
                </div>
            </div>

            <!-- 실험 영역 -->
            <div class="experiment-area">
                <div class="simulation-container">
                    <div class="status-indicator status-ready" id="statusIndicator">실험 준비 중</div>
                    <div class="timer-display" id="timerDisplay">0.0초</div>
                    <canvas id="experimentCanvas"></canvas>
                    <div class="particle-legend">
                        <div class="legend-item">
                            <div class="legend-color" style="background: #2196F3;"></div>
                            <span>암모니아 입자 (NH₃)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #FF9800;"></div>
                            <span>만능 지시약 종이</span>
                        </div>
                    </div>
                </div>

                <div class="results-section">
                    <div class="result-card">
                        <h4>📈 시간-거리 그래프</h4>
                        <canvas id="graphCanvas"></canvas>
                    </div>
                    <div class="result-card">
                        <h4>📋 실험 결과 데이터</h4>
                        <table class="data-table">
                            <tr>
                                <td>온도 조건</td>
                                <td id="resultTemp">-</td>
                            </tr>
                            <tr>
                                <td>암모니아 농도</td>
                                <td id="resultDrop">-</td>
                            </tr>
                            <tr>
                                <td>빨대 길이</td>
                                <td id="resultLength">-</td>
                            </tr>
                            <tr>
                                <td>색 변화 시작 시간</td>
                                <td id="resultTime">-</td>
                            </tr>
                            <tr>
                                <td>평균 확산 속도</td>
                                <td id="resultSpeed">-</td>
                            </tr>
                            <tr>
                                <td>도달 거리</td>
                                <td id="resultDistance">-</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <div class="feedback-section" id="feedbackSection" style="display: none;">
                    <h3>🤔 탐구 질문</h3>
                    <div class="question-card">
                        <p><strong>Q1.</strong> 암모니아 기체는 왜 직접 닿지 않았는데도 지시약 종이의 색을 변하게 했을까요?</p>
                        <div class="hint-box">
                            <p><strong>힌트:</strong> 기체는 입자들로 이루어져 있으며, 이 입자들은 끊임없이 움직입니다. 암모니아 입자가 공기 중을 어떻게 이동했는지 생각해보세요.</p>
                        </div>
                    </div>
                    <div class="question-card">
                        <p><strong>Q2.</strong> 어떤 조건에서 확산이 더 빨랐나요? 그 이유는 무엇일까요?</p>
                        <div class="hint-box">
                            <p><strong>힌트:</strong> 온도가 높을수록 입자들의 운동 에너지가 증가합니다. 실험 결과에서 온도 변화에 따른 시간 차이를 비교해보세요.</p>
                        </div>
                    </div>
                    <div class="question-card">
                        <p><strong>Q3.</strong> 일상생활에서 기체의 확산을 관찰할 수 있는 예를 들어보세요.</p>
                        <div class="hint-box">
                            <p><strong>힌트:</strong> 음식 냄새가 퍼지는 것, 향수 냄새, 가스 누출 감지 등이 모두 확산의 예입니다.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 실험 설정 변수
        let experimentConfig = {
            temperature: 25,
            drops: 2,
            length: 'medium',
            lengthCm: 30
        };

        // 실험 상태
        let experimentState = {
            isRunning: false,
            startTime: 0,
            currentTime: 0,
            particles: [],
            colorChangeTime: null,
            graphData: []
        };

        // 캔버스 설정
        const canvas = document.getElementById('experimentCanvas');
        const ctx = canvas.getContext('2d');
        const graphCanvas = document.getElementById('graphCanvas');
        const graphCtx = graphCanvas.getContext('2d');

        function resizeCanvas() {
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            graphCanvas.width = graphCanvas.offsetWidth;
            graphCanvas.height = graphCanvas.offsetHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // 길이 맵핑
        const lengthMap = {
            'short': 20,
            'medium': 30,
            'long': 40
        };

        // 온도 버튼 이벤트
        document.querySelectorAll('[data-temp]').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('[data-temp]').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                experimentConfig.temperature = parseInt(this.dataset.temp);
            });
        });

        // 길이 버튼 이벤트
        document.querySelectorAll('[data-length]').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('[data-length]').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                experimentConfig.length = this.dataset.length;
                experimentConfig.lengthCm = lengthMap[this.dataset.length];
            });
        });

        // 슬라이더 이벤트
        document.getElementById('dropSlider').addEventListener('input', function() {
            experimentConfig.drops = parseInt(this.value);
            document.getElementById('dropValue').textContent = this.value;
        });

        // 입자 클래스
        class Particle {
            constructor(x, y, speed) {
                this.x = x;
                this.y = y;
                this.speed = speed;
                this.angle = Math.random() * Math.PI * 2;
                this.vx = Math.cos(this.angle) * this.speed;
                this.vy = Math.sin(this.angle) * this.speed;
                this.radius = 3;
                this.color = '#2196F3';
            }

            update() {
                // 무작위 방향 변화 (충돌 시뮬레이션)
                if (Math.random() < 0.05) {
                    this.angle = Math.random() * Math.PI * 2;
                    this.vx = Math.cos(this.angle) * this.speed;
                    this.vy = Math.sin(this.angle) * this.speed;
                }

                this.x += this.vx;
                this.y += this.vy;

                // 빨대 내부 경계 반사
                const tubeY = canvas.height / 2;
                const tubeHeight = 80;
                if (this.y < tubeY - tubeHeight/2 || this.y > tubeY + tubeHeight/2) {
                    this.vy = -this.vy;
                    this.y = Math.max(tubeY - tubeHeight/2, Math.min(tubeY + tubeHeight/2, this.y));
                }
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                
                // 입자 주변 효과
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius + 2, 0, Math.PI * 2);
                ctx.strokeStyle = 'rgba(33, 150, 243, 0.3)';
                ctx.lineWidth = 1;
                ctx.stroke();
            }
        }

        // 실험 시작
        document.getElementById('startBtn').addEventListener('click', startExperiment);

        function startExperiment() {
            if (experimentState.isRunning) return;

            experimentState.isRunning = true;
            experimentState.startTime = Date.now();
            experimentState.currentTime = 0;
            experimentState.particles = [];
            experimentState.colorChangeTime = null;
            experimentState.graphData = [];

            // 상태 표시 업데이트
            document.getElementById('statusIndicator').className = 'status-indicator status-running';
            document.getElementById('statusIndicator').textContent = '실험 진행 중';

            // 입자 속도 계산 (온도에 비례)
            const baseSpeed = 1;
            const tempFactor = experimentConfig.temperature / 25;
            const particleSpeed = baseSpeed * tempFactor;

            // 입자 생성 (농도에 비례)
            const particleCount = experimentConfig.drops * 30;
            for (let i = 0; i < particleCount; i++) {
                const particle = new Particle(
                    50 + Math.random() * 30,
                    canvas.height / 2 + (Math.random() - 0.5) * 60,
                    particleSpeed
                );
                experimentState.particles.push(particle);
            }

            // 애니메이션 루프
            animate();
        }

        // 애니메이션
        function animate() {
            if (!experimentState.isRunning) return;

            experimentState.currentTime = (Date.now() - experimentState.startTime) / 1000;
            
            // 캔버스 초기화
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // 빨대 그리기
            const tubeY = canvas.height / 2;
            const tubeHeight = 80;
            const tubeLength = (experimentConfig.lengthCm / 40) * (canvas.width - 150);
            
            ctx.fillStyle = '#e0e0e0';
            ctx.fillRect(30, tubeY - tubeHeight/2, tubeLength, tubeHeight);
            
            ctx.strokeStyle = '#757575';
            ctx.lineWidth = 3;
            ctx.strokeRect(30, tubeY - tubeHeight/2, tubeLength, tubeHeight);

            // 암모니아 위치 표시
            ctx.fillStyle = '#4CAF50';
            ctx.beginPath();
            ctx.arc(50, tubeY, 15, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = 'white';
            ctx.font = 'bold 10px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('NH₃', 50, tubeY + 4);

            // 지시약 종이 위치
            const indicatorX = 30 + tubeLength - 30;
            ctx.fillStyle = '#FF9800';
            ctx.fillRect(indicatorX - 5, tubeY - tubeHeight/2, 10, tubeHeight);

            // 입자 업데이트 및 그리기
            let maxReachedX = 0;
            experimentState.particles.forEach(particle => {
                particle.update();
                particle.draw();
                
                if (particle.x > maxReachedX) {
                    maxReachedX = particle.x;
                }

                // 지시약에 도달 체크
                if (particle.x >= indicatorX - 10 && !experimentState.colorChangeTime) {
                    experimentState.colorChangeTime = experimentState.currentTime;
                    document.getElementById('feedbackSection').style.display = 'block';
                }
            });

            // 색 변화 효과
            if (experimentState.colorChangeTime) {
                const timeSinceChange = experimentState.currentTime - experimentState.colorChangeTime;
                const colorIntensity = Math.min(timeSinceChange / 2, 1);
                
                ctx.fillStyle = `rgba(76, 175, 80, ${colorIntensity})`;
                ctx.fillRect(indicatorX - 5, tubeY - tubeHeight/2, 10, tubeHeight);
                
                ctx.fillStyle = 'white';
                ctx.font = 'bold 12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('색변화!', indicatorX, tubeY - tubeHeight/2 - 10);
            }

            // 타이머 업데이트
            document.getElementById('timerDisplay').textContent = experimentState.currentTime.toFixed(1) + '초';

            // 그래프 데이터 추가
            const reachedDistance = ((maxReachedX - 30) / tubeLength) * experimentConfig.lengthCm;
            experimentState.graphData.push({
                time: experimentState.currentTime,
                distance: Math.max(0, reachedDistance)
            });

            // 그래프 업데이트
            drawGraph();

            // 실험 종료 조건
            if (experimentState.colorChangeTime && experimentState.currentTime - experimentState.colorChangeTime > 3) {
                completeExperiment();
                return;
            }

            if (experimentState.currentTime > 60) {
                completeExperiment();
                return;
            }

            requestAnimationFrame(animate);
        }

        // 그래프 그리기
        function drawGraph() {
            if (experimentState.graphData.length < 2) return;

            graphCtx.clearRect(0, 0, graphCanvas.width, graphCanvas.height);

            const padding = 40;
            const graphWidth = graphCanvas.width - padding * 2;
            const graphHeight = graphCanvas.height - padding * 2;

            // 축 그리기
            graphCtx.strokeStyle = '#333';
            graphCtx.lineWidth = 2;
            graphCtx.beginPath();
            graphCtx.moveTo(padding, padding);
            graphCtx.lineTo(padding, graphCanvas.height - padding);
            graphCtx.lineTo(graphCanvas.width - padding, graphCanvas.height - padding);
            graphCtx.stroke();

            // 레이블
            graphCtx.fillStyle = '#333';
            graphCtx.font = '12px Arial';
            graphCtx.textAlign = 'center';
            graphCtx.fillText('시간 (초)', graphCanvas.width / 2, graphCanvas.height - 10);
            
            graphCtx.save();
            graphCtx.translate(15, graphCanvas.height / 2);
            graphCtx.rotate(-Math.PI / 2);
            graphCtx.fillText('거리 (cm)', 0, 0);
            graphCtx.restore();

            // 데이터 스케일링
            const maxTime = Math.max(...experimentState.graphData.map(d => d.time));
            const maxDistance = experimentConfig.lengthCm;

            // 데이터 포인트 그리기
            graphCtx.strokeStyle = '#2196F3';
            graphCtx.lineWidth = 3;
            graphCtx.beginPath();

            experimentState.graphData.forEach((point, index) => {
                const x = padding + (point.time / maxTime) * graphWidth;
                const y = graphCanvas.height - padding - (point.distance / maxDistance) * graphHeight;

                if (index === 0) {
                    graphCtx.moveTo(x, y);
                } else {
                    graphCtx.lineTo(x, y);
                }
            });

            graphCtx.stroke();

            // 포인트 표시
            experimentState.graphData.forEach((point, index) => {
                if (index % 10 === 0) {
                    const x = padding + (point.time / maxTime) * graphWidth;
                    const y = graphCanvas.height - padding - (point.distance / maxDistance) * graphHeight;
                    
                    graphCtx.fillStyle = '#2196F3';
                    graphCtx.beginPath();
                    graphCtx.arc(x, y, 4, 0, Math.PI * 2);
                    graphCtx.fill();
                }
            });
        }

        // 실험 완료
        function completeExperiment() {
            experimentState.isRunning = false;
            
            document.getElementById('statusIndicator').className = 'status-indicator status-complete';
            document.getElementById('statusIndicator').textContent = '실험 완료';

            // 결과 업데이트
            document.getElementById('resultTemp').textContent = experimentConfig.temperature + '°C';
            document.getElementById('resultDrop').textContent = experimentConfig.drops + ' 방울';
            document.getElementById('resultLength').textContent = experimentConfig.lengthCm + ' cm';
            
            if (experimentState.colorChangeTime) {
                document.getElementById('resultTime').textContent = experimentState.colorChangeTime.toFixed(2) + ' 초';
                const speed = (experimentConfig.lengthCm / experimentState.colorChangeTime).toFixed(2);
                document.getElementById('resultSpeed').textContent = speed + ' cm/s';
                document.getElementById('resultDistance').textContent = experimentConfig.lengthCm + ' cm';
            } else {
                document.getElementById('resultTime').textContent = '미도달';
                document.getElementById('resultSpeed').textContent = '-';
                document.getElementById('resultDistance').textContent = '-';
            }
        }

        // 초기화
        document.getElementById('resetBtn').addEventListener('click', function() {
            experimentState.isRunning = false;
            experimentState.particles = [];
            experimentState.colorChangeTime = null;
            experimentState.graphData = [];
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            graphCtx.clearRect(0, 0, graphCanvas.width, graphCanvas.height);
            
            document.getElementById('statusIndicator').className = 'status-indicator status-ready';
            document.getElementById('statusIndicator').textContent = '실험 준비 중';
            document.getElementById('timerDisplay').textContent = '0.0초';
            document.getElementById('feedbackSection').style.display = 'none';
            
            // 결과 초기화
            document.getElementById('resultTemp').textContent = '-';
            document.getElementById('resultDrop').textContent = '-';
            document.getElementById('resultLength').textContent = '-';
            document.getElementById('resultTime').textContent = '-';
            document.getElementById('resultSpeed').textContent = '-';
            document.getElementById('resultDistance').textContent = '-';
        });

        // 보고서 생성
        document.getElementById('reportBtn').addEventListener('click', function() {
            if (!experimentState.colorChangeTime) {
                alert('먼저 실험을 완료해주세요!');
                return;
            }

            generateReport();
        });

        function generateReport() {
            const report = `
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    기체의 확산 실험 보고서
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📋 실험 정보
단원: Ⅳ. 기체의 성질
성취기준: 중1 과학 4-01
실험 주제: 암모니아 기체의 확산 관찰
실험일시: ${new Date().toLocaleString('ko-KR')}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🔬 실험 조건
• 온도: ${experimentConfig.temperature}°C
• 암모니아 농도: ${experimentConfig.drops} 방울
• 빨대 길이: ${experimentConfig.lengthCm} cm

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📊 실험 결과
• 색 변화 시작 시간: ${experimentState.colorChangeTime.toFixed(2)} 초
• 평균 확산 속도: ${(experimentConfig.lengthCm / experimentState.colorChangeTime).toFixed(2)} cm/s
• 도달 거리: ${experimentConfig.lengthCm} cm

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💡 실험 분석

1. 확산 현상 관찰
   암모니아 기체 입자들이 빨대 내부를 통해 이동하여
   만능 지시약 종이에 도달했습니다. 이는 기체 입자들이
   끊임없이 무작위로 운동하기 때문입니다.

2. 온도의 영향
   온도: ${experimentConfig.temperature}°C
   ${experimentConfig.temperature > 25 
       ? '높은 온도에서 입자의 운동 에너지가 증가하여 확산이 빠르게 일어났습니다.'
       : experimentConfig.temperature < 25
       ? '낮은 온도에서 입자의 운동 에너지가 감소하여 확산이 느리게 일어났습니다.'
       : '상온에서 적절한 속도로 확산이 일어났습니다.'}

3. 입자 운동 이론
   • 기체는 작은 입자들로 이루어져 있습니다.
   • 입자들은 모든 방향으로 끊임없이 움직입니다.
   • 입자들은 서로 충돌하며 방향을 바꿉니다.
   • 온도가 높을수록 입자의 속도가 빠릅니다.

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🤔 탐구 질문 답변

Q1. 암모니아 기체는 왜 직접 닿지 않았는데도 
    지시약 종이의 색을 변하게 했을까요?

A1. 암모니아 기체를 구성하는 입자들이 끊임없이
    무작위로 운동하면서 공간 속으로 퍼져나갔기 때문입니다.
    이러한 현상을 '확산'이라고 합니다.

Q2. 어떤 조건에서 확산이 더 빨랐나요?

A2. 온도가 높을수록 입자의 운동 에너지가 커져서
    확산 속도가 빨라집니다. 또한 농도가 진할수록
    더 많은 입자가 이동하여 빠르게 도달합니다.

Q3. 일상생활에서의 확산 예시

A3. 
• 음식 냄새가 멀리까지 퍼지는 현상
• 향수나 방향제의 향기가 퍼지는 현상
• 가스 누출 시 냄새로 감지되는 현상
• 아침에 이슬이 증발하여 사라지는 현상

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ 학습 성취도 평가

성취기준 4-01 달성도: ★★★★★

• 확산 현상 관찰: 완료
• 입자 운동 설명: 완료
• 온도 영향 이해: 완료
• 실생활 연계: 완료

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📝 실험자 메모
(학생이 직접 작성)

_______________________________________________
_______________________________________________
_______________________________________________

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
            `;

            // 보고서 다운로드
            const blob = new Blob([report], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `기체확산실험_보고서_${new Date().getTime()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert('📊 실험 보고서가 다운로드되었습니다!\n\n파일을 열어서 실험 결과를 확인하고,\n실험자 메모를 작성해보세요.');
        }

        // 초기 그리기
        ctx.fillStyle = '#666';
        ctx.font = '20px Arial';
        ctx.textAlign = 'center';
        ctx.fillText('실험 시작 버튼을 눌러주세요', canvas.width / 2, canvas.height / 2);
    </script>
</body>
</html>
